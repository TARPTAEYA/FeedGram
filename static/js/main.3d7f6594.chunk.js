(this.webpackJsonpfeedgram=this.webpackJsonpfeedgram||[]).push([[0],{119:function(e,t){},121:function(e,t){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(68),c=n.n(o),l=(n(81),n(6)),i=(n(82),n(83),n(17)),s=n.n(i),u=n(69),d=n(70),m=n(74),f=n(71),v=n(21),h=n(75);n(85);function g(){var e=window.localStorage.getItem("channels");return e||(e="[]"),e=JSON.parse(e)}function E(e){window.localStorage.setItem("channels",JSON.stringify(e)),window.localStorage.setItem("lastFetched","0")}var p=n(72),w=n.n(p);var S=function(e){var t,n,a;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new w.a,r.next=3,s.a.awrap(t.parseURL(e));case 3:for(delete(n=r.sent).copyright,delete n.description,delete n.generator,delete n.language,a=0;a<n.items.length;a++)delete n.items[a].content,delete n.items[a].guid,n.items[a].contentSnippet=(o=n.items[a].contentSnippet)?((o=o.split(/^(.*?)[.?!]\s/)[0]).length>200&&(o=o.substring(0,200)+"..."),o):o;return r.abrupt("return",n);case 10:case"end":return r.stop()}var o}))},b=n(73),y=n.n(b);n(136);var k=function(e){return r.a.createElement("div",{className:"Card"},r.a.createElement("div",{className:"CardHeading"},r.a.createElement("div",{className:"SourceIcon",style:{backgroundImage:'url("'.concat(e.item.channel.icon,'")')}}),r.a.createElement("div",{className:"SourceMetadata"},r.a.createElement("div",{className:"SourceName"},e.item.author||e.item.creator||e.item.channel.title),r.a.createElement("div",{className:"SourcePubDate"},y()(e.item.pubDate).fromNow()))),r.a.createElement("div",{className:"CardContent"},r.a.createElement("h3",null,e.item.title),r.a.createElement("div",null,e.item.contentSnippet),r.a.createElement("div",null,r.a.createElement("a",{href:e.item.link,target:"_blank",rel:"noopener noreferrer"},"Read More"))))};n(137);var C=function(){return r.a.createElement("div",{className:"LoadIndicator"},r.a.createElement("div",{className:"LoadIndicatorIcon"}))};function N(e){return"https://cors-anywhere.herokuapp.com/".concat(e)}var O=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={feeds:[],feedsToLoad:0},n.onFeedLoaded=n.onFeedLoaded.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setStateSafe",value:function(e){this.mounted&&this.setState(e)}},{key:"setStateAsync",value:function(e){var t=this;return new Promise((function(n){return t.setStateSafe(e,n)}))}},{key:"componentDidMount",value:function(){this.mounted=!0;var e=window.localStorage.getItem("lastFetched",Date.now());if(!e||Date.now()-parseInt(e)>6e4)this.fetchFeeds();else{var t=window.localStorage.getItem("feeds"),n=JSON.parse(t);this.setStateSafe({feeds:n,feedsToLoad:0})}}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"fetchFeeds",value:function(){var e,t,n,a,r=this;return s.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=g(),o.next=3,s.a.awrap(this.setStateAsync({feedsToLoad:e.length}));case 3:t=0;case 4:if(!(t<e.length)){o.next=14;break}if((n=e[t]).active){o.next=9;break}return this.onFeedLoaded(),o.abrupt("continue",11);case 9:a=N(n.address),S(a).then((function(e){return r.setStateSafe({feeds:r.state.feeds.concat(e)})})).catch((function(e){console.log(e)})).finally(this.onFeedLoaded);case 11:t++,o.next=4;break;case 14:case"end":return o.stop()}}),null,this)}},{key:"onFeedLoaded",value:function(){this.setStateSafe({feedsToLoad:this.state.feedsToLoad-1}),0===this.state.feedsToLoad&&this.saveFeeds()}},{key:"saveFeeds",value:function(){var e=JSON.stringify(this.state.feeds);window.localStorage.setItem("feeds",e),window.localStorage.setItem("lastFetched",Date.now())}},{key:"render",value:function(){var e=[];if(0===this.state.feedsToLoad){for(var t=[],n=0;n<this.state.feeds.length;n++){var a=this.state.feeds[n];console.log(a);for(var o=0;o<a.items.length;o++){var c=a.items[o];c.channel={},c.channel.title=a.title,c.channel.link=a.link;var l=new URL(a.link);c.channel.icon="https://f1.allesedv.com/32/".concat(l.hostname),t.push(c)}}t.sort((function(e,t){return e.isoDate>t.isoDate?-1:1}));for(var i=0;i<t.length;i++)e.push(r.a.createElement(k,{key:i,item:t[i]}))}return r.a.createElement("div",{className:"HomePage"},0===this.state.feedsToLoad?e:r.a.createElement(C,null))}}]),t}(a.Component),j=(n(138),n(0)),L=n(9);var F=function(e){var t=Object(a.useState)(e.item.active),n=Object(l.a)(t,2),o=n[0],c=n[1];return r.a.createElement("div",{className:"Channel"},r.a.createElement("div",{className:"ChannelMetadata"},r.a.createElement("h3",null,e.item.title),r.a.createElement("div",null,e.item.address)),r.a.createElement("div",{className:"ChannelAction"},r.a.createElement(j.b.Provider,{value:{size:"1.5em"}},r.a.createElement(L.a,{onClick:function(){c(!o),e.toggleChannel(e.item)},style:{marginRight:18,color:o?"var(--primary-color)":"var(--light-text-color)"}}),r.a.createElement(L.c,{style:{color:"red"},onClick:function(){return e.removeChannel(e.item)}}))))};n(139);function I(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(""),s=Object(l.a)(i,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"ChannelModalOuter",onClick:function(){return e.onReject()}},r.a.createElement("div",{className:"ChannelModal",onClick:function(e){return e.stopPropagation()}},r.a.createElement("h3",null,"Add New Channel"),r.a.createElement("input",{type:"text",placeholder:"Title",value:o,onChange:function(e){return c(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Feed Address",value:u,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{onClick:function(){if(o.trim()&&u.trim()){var t={};t.title=o,t.address=u,t.active=!0,e.saveChannel(t),e.onReject()}}},"Save")))}var x=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),o=n[0],c=n[1];return r.a.createElement(r.a.Fragment,null,o?r.a.createElement(I,{saveChannel:e.saveChannel,onReject:function(){return c(!1)}}):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{className:"FabAddButton",onClick:function(){return c(!0)}},r.a.createElement(j.b.Provider,{value:{size:"2em"}},r.a.createElement(L.d,{style:{color:"white"}}))))};n(140);var A=function(){var e=Object(a.useState)(g()),t=Object(l.a)(e,2),n=t[0],o=t[1];function c(e){o(function(e){for(var t=g(),n=0;n<t.length&&t[n].address!==e.address;n++);return t[n].active=!e.active,E(t),t}(e))}function i(e){o(function(e){var t=g();return t.splice(t.indexOf(e),1),E(t),t}(e))}return r.a.createElement("div",{className:"ChannelListPage"},n.map((function(e,t){return r.a.createElement(F,{key:t,item:e,toggleChannel:c,removeChannel:i})})),r.a.createElement(x,{saveChannel:function(e){o(function(e){var t=g();return t.push(e),E(t),t}(e))}}))};n(141);var T=function(){return r.a.createElement("div",{className:"SettingsPage"},r.a.createElement("div",null,"About FeedGram"),r.a.createElement("div",null,"Contact"),r.a.createElement("div",null,"Terms of Use"),r.a.createElement("div",null,"Open Source Licenses"),r.a.createElement("div",{onClick:function(){window.localStorage.setItem("lastFetched","0"),window.localStorage.setItem("feeds","[]"),window.location.reload()}},"Empty Feeds Cache"),r.a.createElement("div",{onClick:function(){window.localStorage.clear(),window.location.reload()},style:{color:"red"}},"Clear All Data"))};var P=function(){var e=Object(a.useState)(0),t=Object(l.a)(e,2),n=t[0],o=t[1],c=[r.a.createElement(O,null),r.a.createElement(A,null),r.a.createElement(T,null)];return r.a.createElement("div",{className:"TabView"},c[n],r.a.createElement("div",{className:"BottomAppBar"},r.a.createElement(j.b.Provider,{value:{size:"1.5em"}},r.a.createElement("div",{onClick:function(){return o(0)},style:{color:0===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.b,null)),r.a.createElement("div",{onClick:function(){return o(1)},style:{color:1===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.f,null)),r.a.createElement("div",{onClick:function(){return o(2)},style:{color:2===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.e,null)))))};n(142);var W=function(e){var t=0,n=[r.a.createElement(C,null),r.a.createElement("div",{style:{flex:1,textAlign:"center"}},r.a.createElement("button",{onClick:function(){window.localStorage.setItem("channels",JSON.stringify([{title:"CNN World",address:"http://rss.cnn.com/rss/edition_world.rss",active:!0,category:"news"},{title:"ELLE",address:"https://www.elle.com/rss/all.xml/",active:!0,category:"fashion"},{title:"WIRED",address:"https://www.wired.com/feed/rss",active:!0,category:"technology"}])),e.onClicked()}},"Continue"))];return 0===g().length?t=1:e.onClicked(),r.a.createElement("div",{className:"page StartPage"},r.a.createElement("div",{style:{flex:t+1}},r.a.createElement("h1",null,"Welcome to ",r.a.createElement("span",null,"FeedGram")),r.a.createElement("p",null,"Get latest news and feeds from sources you love for free!")),n[t],r.a.createElement("div",{className:"container",style:{textAlign:"center"}},r.a.createElement("p",null,"v0.1.0"),r.a.createElement("p",null,"Built with love in India.")))};var R=function(){var e=Object(a.useState)(0),t=Object(l.a)(e,2),n=t[0],o=t[1];return[r.a.createElement(W,{onClicked:function(){return o(1)}}),r.a.createElement(P,null)][n]},D=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function J(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(R,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/feedgram",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/feedgram","/service-worker.js");D?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):J(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):J(t,e)}))}}()},76:function(e,t,n){e.exports=n(143)},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){},92:function(e,t){},94:function(e,t){}},[[76,1,2]]]);
//# sourceMappingURL=main.3d7f6594.chunk.js.map