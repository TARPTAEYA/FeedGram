(this.webpackJsonpfeedgram=this.webpackJsonpfeedgram||[]).push([[0],{119:function(e,t){},121:function(e,t){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),l=n(69),c=n.n(l),o=(n(81),n(6)),i=(n(82),n(83),n(18)),s=n.n(i),u=n(70),d=n(71),m=n(74),f=n(72),v=n(22),h=n(75);n(85);function E(){var e=window.localStorage.getItem("channels");return e||(e="[]"),e=JSON.parse(e)}function g(e){window.localStorage.setItem("channels",JSON.stringify(e)),window.localStorage.setItem("lastFetched","0")}var p=n(73),w=n.n(p);var S=function(e){var t,n,a;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new w.a,r.next=3,s.a.awrap(t.parseURL(e));case 3:for(delete(n=r.sent).copyright,delete n.description,delete n.generator,delete n.language,a=0;a<n.items.length;a++)delete n.items[a].content,delete n.items[a].guid,n.items[a].contentSnippet=(l=n.items[a].contentSnippet)?((l=l.split(/^(.*?)[.?!]\s/)[0]).length>200&&(l=l.substring(0,200)+"..."),l):l;return r.abrupt("return",n);case 10:case"end":return r.stop()}var l}))},b=n(19),y=n.n(b);n(136);var C=function(e){return r.a.createElement("div",{className:"Card"},r.a.createElement("div",{className:"CardHeading"},r.a.createElement("div",{className:"SourceIcon",style:{backgroundImage:'url("'.concat(e.item.channel.icon,'")')}}),r.a.createElement("div",{className:"SourceMetadata"},r.a.createElement("div",{className:"SourceName"},e.item.author||e.item.creator||e.item.channel.title),r.a.createElement("div",{className:"SourcePubDate"},y()(e.item.pubDate).fromNow()))),r.a.createElement("div",{className:"CardContent"},r.a.createElement("h3",null,e.item.title),r.a.createElement("div",null,e.item.contentSnippet),r.a.createElement("div",null,r.a.createElement("a",{href:e.item.link,target:"_blank",rel:"noopener noreferrer"},"Read More"))))};n(137);var k=function(){return r.a.createElement("div",{className:"LoadIndicator"},r.a.createElement("div",{className:"LoadIndicatorIcon"}))};function N(e){return"https://cors-anywhere.herokuapp.com/".concat(e)}var O=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={feeds:[],feedsToLoad:0},n.onFeedLoaded=n.onFeedLoaded.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setStateSafe",value:function(e){this.mounted&&this.setState(e)}},{key:"componentDidMount",value:function(){this.mounted=!0;var e=window.localStorage.getItem("lastFetched",Date.now());if(!e||Date.now()-parseInt(e)>6e4)this.fetchFeeds();else{var t=window.localStorage.getItem("feeds"),n=JSON.parse(t);this.setStateSafe({feeds:n,feedsToLoad:0})}}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"fetchFeeds",value:function(){var e,t,n,a,r=this;return s.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:e=E(),this.setStateSafe({feedsToLoad:this.state.feedsToLoad+e.length}),t=0;case 3:if(!(t<e.length)){l.next=14;break}if((n=e[t]).active){l.next=8;break}return this.onFeedLoaded(),l.abrupt("continue",11);case 8:a=N(n.address),console.log("fetching feeds from "+a),S(a).then((function(e){return r.setStateSafe({feeds:r.state.feeds.concat(e)})})).catch((function(e){console.log(e)})).finally(this.onFeedLoaded);case 11:t++,l.next=3;break;case 14:case"end":return l.stop()}}),null,this)}},{key:"onFeedLoaded",value:function(){this.setStateSafe({feedsToLoad:this.state.feedsToLoad-1}),0===this.state.feedsToLoad&&this.saveFeeds()}},{key:"saveFeeds",value:function(){var e=JSON.stringify(this.state.feeds);window.localStorage.setItem("feeds",e),window.localStorage.setItem("lastFetched",Date.now())}},{key:"render",value:function(){var e=[];if(0===this.state.feedsToLoad){for(var t=[],n=0;n<this.state.feeds.length;n++)for(var a=this.state.feeds[n],l=0;l<a.items.length;l++){var c=a.items[l];c.channel={},c.channel.title=a.title,c.channel.link=a.link;var o=new URL(a.link);c.channel.icon="https://f1.allesedv.com/32/".concat(o.hostname),t.push(c)}t.sort((function(e,t){return y()(e.pubDate).unix()>y()(t.pubDate).unix()?-1:1}));for(var i=0;i<t.length;i++)e.push(r.a.createElement(C,{key:i,item:t[i]}))}return r.a.createElement("div",{className:"HomePage"},0===this.state.feedsToLoad?e:r.a.createElement(k,null))}}]),t}(a.Component),j=(n(138),n(0)),L=n(9);var F=function(e){var t=Object(a.useState)(e.item.active),n=Object(o.a)(t,2),l=n[0],c=n[1];return r.a.createElement("div",{className:"Channel"},r.a.createElement("div",{className:"ChannelMetadata"},r.a.createElement("h3",null,e.item.title),r.a.createElement("div",null,e.item.address)),r.a.createElement("div",{className:"ChannelAction"},r.a.createElement(j.b.Provider,{value:{size:"1.5em"}},r.a.createElement(L.a,{onClick:function(){c(!l),e.toggleChannel(e.item)},style:{marginRight:18,color:l?"var(--primary-color)":"var(--light-text-color)"}}),r.a.createElement(L.c,{style:{color:"red"},onClick:function(){return e.removeChannel(e.item)}}))))};n(139);function I(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),l=n[0],c=n[1],i=Object(a.useState)(""),s=Object(o.a)(i,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"ChannelModalOuter",onClick:function(){return e.onReject()}},r.a.createElement("div",{className:"ChannelModal",onClick:function(e){return e.stopPropagation()}},r.a.createElement("h3",null,"Add New Channel"),r.a.createElement("input",{type:"text",placeholder:"Title",value:l,onChange:function(e){return c(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Feed Address",value:u,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{onClick:function(){if(l.trim()&&u.trim()){var t={};t.title=l,t.address=u,t.active=!0,e.saveChannel(t),e.onReject()}}},"Save")))}var x=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),l=n[0],c=n[1];return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(I,{saveChannel:e.saveChannel,onReject:function(){return c(!1)}}):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{className:"FabAddButton",onClick:function(){return c(!0)}},r.a.createElement(j.b.Provider,{value:{size:"2em"}},r.a.createElement(L.d,{style:{color:"white"}}))))};n(140);var T=function(){var e=Object(a.useState)(E()),t=Object(o.a)(e,2),n=t[0],l=t[1];function c(e){l(function(e){for(var t=E(),n=0;n<t.length&&t[n].address!==e.address;n++);return t[n].active=!e.active,g(t),t}(e))}function i(e){l(function(e){var t=E();return t.splice(t.indexOf(e),1),g(t),t}(e))}return r.a.createElement("div",{className:"ChannelListPage"},n.map((function(e,t){return r.a.createElement(F,{key:t,item:e,toggleChannel:c,removeChannel:i})})),r.a.createElement(x,{saveChannel:function(e){l(function(e){var t=E();return t.push(e),g(t),t}(e))}}))};n(141);var D=function(){return r.a.createElement("div",{className:"SettingsPage"},r.a.createElement("div",null,"About FeedGram"),r.a.createElement("div",null,"Contact"),r.a.createElement("div",null,"Terms of Use"),r.a.createElement("div",null,"Open Source Licenses"),r.a.createElement("div",{onClick:function(){window.localStorage.setItem("lastFetched","0"),window.localStorage.setItem("feeds","[]"),window.location.reload()}},"Empty Feeds Cache"),r.a.createElement("div",{onClick:function(){window.localStorage.clear(),window.location.reload()},style:{color:"red"}},"Clear All Data"))};var A=function(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],l=t[1],c=[r.a.createElement(O,null),r.a.createElement(T,null),r.a.createElement(D,null)];return r.a.createElement("div",{className:"TabView"},c[n],r.a.createElement("div",{className:"BottomAppBar"},r.a.createElement(j.b.Provider,{value:{size:"1.5em"}},r.a.createElement("div",{onClick:function(){return l(0)},style:{color:0===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.b,null)),r.a.createElement("div",{onClick:function(){return l(1)},style:{color:1===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.f,null)),r.a.createElement("div",{onClick:function(){return l(2)},style:{color:2===n?"var(--primary-color)":"inherit"}},r.a.createElement(L.e,null)))))};n(142);var P=function(e){var t=0,n=[r.a.createElement(k,null),r.a.createElement("div",{style:{flex:1,textAlign:"center"}},r.a.createElement("button",{onClick:function(){window.localStorage.setItem("channels",JSON.stringify([{title:"CNN World",address:"http://rss.cnn.com/rss/edition_world.rss",active:!0,category:"news"},{title:"ELLE",address:"https://www.elle.com/rss/all.xml/",active:!0,category:"fashion"},{title:"WIRED",address:"https://www.wired.com/feed/rss",active:!0,category:"technology"}])),e.onClicked()}},"Continue"))];return 0===E().length?t=1:e.onClicked(),r.a.createElement("div",{className:"page StartPage"},r.a.createElement("div",{style:{flex:t+1}},r.a.createElement("h1",null,"Welcome to ",r.a.createElement("span",null,"FeedGram")),r.a.createElement("p",null,"Get latest news and feeds from sources you love for free!")),n[t],r.a.createElement("div",{className:"container",style:{textAlign:"center"}},r.a.createElement("p",null,"v0.1.0"),r.a.createElement("p",null,"Built with love in India.")))};var R=function(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],l=t[1];return[r.a.createElement(P,{onClicked:function(){return l(1)}}),r.a.createElement(A,null)][n]};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,t,n){e.exports=n(143)},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){},92:function(e,t){},94:function(e,t){}},[[76,1,2]]]);
//# sourceMappingURL=main.d81271de.chunk.js.map